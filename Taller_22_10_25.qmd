---
title: "Ejercicios de Estadística descriptiva multivariante"
format:
  html:
    theme: lumen
    toc: true
editor: 
  markdown: 
    wrap: 72
---

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(GGally)
library(tidyverse)
```

## Ejercicio

Una empresa quiere analizar si existe relación entre las ventas de sus
productos, la inversión en publicidad y la satisfacción del cliente. Los
datos que corresponden a las ventas en miles de unidades, el gasto en
publicidad en miles de euros y la puntuación de satisfacción del cliente
en una escala de 1 a 10 para 15 productos, los puedes descargar en el
siguiente enlace: [datos
empresa](https://github.com/igmuib/Practica_AD/blob/main/datos_empresa.csv)

Leemos los datos

```{r, message=FALSE}
ruta<- "C:/Users/Paula García Ferrer/OneDrive/Escritorio/Analsis_Dades_Multi/Analisis_Dades/Taller1/datos_empresa.csv"
datos_empresa <- read.csv(ruta)
datos_empresa = datos_empresa[1:15,]
library(tidyverse)
glimpse(datos_empresa)
```

### Apartado a

Calcula, por un lado con formulación matricial y, por otro, mediante
instrucciones en R/tidyverse, el vector de medias y la matriz de
covarianzas para las variables cuantitativas del conjunto datos_empresa.
A continuación, interpreta los resultados en el contexto del problema.

#### Respuesta

### Apartado b

Calcula, por un lado con formulación matricial y, por otro, mediante
instrucciones en R/tidyverse la matriz de correlaciones. Presenta una
visualización de ella con la librería `GGally`y la función `ggpairs()`.
Interpreta el resultado en el contexto del problema.

#### Respuesta

### Apartado c

Define una variable compuesta $Y=Xa$ que agregue Ventas, Publicidad y
Satisfaccion_cliente mediante un vector de pesos $a$ justificados con
criterio empresarial, por ejemplo, un índice de rendimiento que priorice
Ventas, o un índice de intensidad de marketing que dé mayor peso a
Publicidad. Calcula por formulación matricial su vector de medias y
matriz de covarianzas muestra, interpreta lo obtenido en el contexto del
problema.

#### Respuesta

Consideremos el vector $a$, con los pesos siguientes: Ventas $(60 \%)$,
ya que representa el rendimiento tangible; Publicidad $(25 \%)$, es el
esfuerzo de marketing que impulsa las ventas y Satisfacción $(15 \%)$
que refleja sostenibilidad futura y reputación de manera que: $$
a=[0.6 \quad  0.25 \quad 0.15]^t
$$ Este vector de pesos suma 1 y asigna la prioridad al resultado
económico. Consideremos ahora la matriz $X$: $$
X = [Ventas \quad Publicidad \quad Satisfacion\_cliente]
$$ Entonces, la varible $Y=Xa$ será: $$
Y = Xa = 0.6 \cdot Ventas + 0.25 \cdot Publicidad + 0.15 \cdot Satisfacion\_cliente
$$ Veamos en R:

```{r, message=FALSE}
# extraemos las varibles que nos interesan del dataframe
X <- as.matrix(datos_empresa[, c("Ventas", "Publicidad", "Satisfaccion_cliente")])

# vector de pesos
a <- matrix(c(0.6, 0.25, 0.15), ncol = 1)

# Calculamos la varible compuesta
Y <- X %*% a

# calculamos el vector de medias
media_X <- colMeans(X)
media_X

# calculamos la matriz de covarianzas
S <- cov(X) * (nrow(X) - 1)/nrow(X)
S

# Media y varianza de Y
media_Y <- t(a) %*% media_X
var_Y <- t(a) %*% S %*% a

# resultados
cat("Media de Y:", media_Y, "\n")
cat("Varianza de Y:", var_Y, "\n")
```

Según los pesos que hemos atribuido a las variables, podemos ver las
contribuciones de las medias a $\bar{Y}$ como suma ponderada de las
medias: $\bar{Y} = a'\bar{X}$, donde $a' = a$.

De esta manera las contribuciones quedan:

-   Ventas -\> $0.6 \cdot 164 = 98,40$ ---\>
    $(98,40 \cdot 100)/media(Y) \approx 91,33 \%$ de la media de Y

-   Publicidad -\> $0.25 \cdot 32,33... = 8,083333...$ -–\>
    $(8,08333... \cdot 100)/media(Y) \approx 7,50 \%$ de la media de Y

-   Satisfaccion_cliente -\> $0.15 \cdot 8,34666... = 1,25199...$ –-\>
    $(1,25199... \cdot 100)/media(Y) \approx 1,16 \%$ de la media de Y

Una interpretación que podemos hacer, es que la media de $Y$ está
practicamente determinada por las ventas, por una parte porque las
ventas tienen la media más alta y por otra porque le hemos dado un peso
mayor, es decir, una mayor prioridad.

De la expresión $Var(Y) = a^tSa$, podemos ver que es $Var(Y)$ es una
forma cuadrática con la matriz de covarianzas. Al ser el término mayor
de $a$ el que acompaña las Ventas, eso quiere decir que la varianza de
las ventas tiene más peso que la varianza y las covarianzas del resto de
variables.

Por lo tanto, el hecho de priorizar las ventas a la hora de definir el
vector de ponderación $a$ implica que las ventas también tienen más peso
a la hora de determinar la media y la varianza de $Y$.

### Apartado d

Usa el teorema de la dimensión para ofrecer una breve interpretación
sobre la redundancia y la dispersión de `datos_empresa`.

#### Respuesta

### Apartado e

Para estos datos calcula la varianza total y la varianza generalizada y
explica qué mide cada una. Comenta cómo cambian si aumentan las
correlaciones entre las variables o si se reescala alguna variable.

#### Respuesta

### Apartado f

Selecciona la medida de distancia más adecuada para identificar qué
observaciones multivariantes son similares y cuáles no.

#### Respuesta
